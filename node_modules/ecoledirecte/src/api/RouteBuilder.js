const methods = ['post'];
const root = ['https://api.ecoledirecte.com', 'v3'];
const request = require('./request');

class RouteBuilder {
    constructor() {
        const route = [...root]; // the url
        let isEndpoint = false;

        const handler = {
            get(target, name) {
                if(methods.includes(name)) {
                    route[route.length-1] += '.awp';
                    const url = route.join('/');
                    route.length = root.length; // route = root;
                    return request(url, name);
                }

                route.push(name);

                isEndpoint = false;
                
                return new Proxy(() => {}, handler);
            },
            apply(target, _, args) {
                route.push(...args);
                return new Proxy(() => {}, handler);
            }
        }

        return new Proxy(() => {}, handler);
    }
}

module.exports = RouteBuilder;